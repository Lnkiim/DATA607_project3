---
title: "Project 3"
author: "Atina Karim"
output:
  pdf_document: default
  html_document:
    includes:
      in_header: header.html
    css: ./lab.css
    highlight: pygments
    theme: cerulean
    toc: true
    toc_float: true
editor_options: 
  chunk_output_type: console
---
# 2019 Kaggle ML and DS Survey

*Load Libraries*
```{r load libraries}
library(odbc)
library(DBI)
library (tidyverse)
library(ggplot2)
```

*Connecting to Azure*
```{r, include=FALSE}
my_connection <- dbConnect(drv = odbc::odbc(),
                           Driver = "SQL Server",
                           server = "data607.database.windows.net",
                           database = "Project3",
                           uid = "",
                           pwd = "")
```

## Dataset 1 (Multiple Choice Responses)
```{r}
Data <- dbGetQuery(my_connection,"Select * FROM dbo.multiple_choice_responses")
```

```{r table-kaggle}
knitr::kable(Data,caption='Kaggle Survey Responses')
```
## Converting to a tibble

```{r tibble}
Data_Tibble <-as_tibble(Data)
Data_Tibble
```
## Filtering out non data roles
Since our research question is "What are the most sought after skills for data scientists?" we are only interested looking at the information for data roles.
```{r}
DataScientists <- filter (Data_Tibble,Q5 == "Data Scientist" | Q5 == "Data Analyst" | Q5 == "Data Engineer")
DataScientists
```

## Responses

We are going to store the responses for **questions 18-34** in separate data frames (q_18,q_19,q_20 and so on till q_34).However, we have excluded questions that are not relevant for our analysis (non skills based questions) 

The section headers below indicate the area of focus for each question (or consecutive questions).

Question 18
```{r}
q_18 <- DataScientists %>% 
  select(starts_with("Q18")& !"Q18_OTHER_TEXT")
q_18 <-q_18 %>% 
  gather(Q,Response)  %>% 
    group_by(Response) %>%
      summarize(count_response = n())
```
Question 19
```{r}
q_19 <- DataScientists %>% 
  select(starts_with("Q19")& !"Q19_OTHER_TEXT")
q_19 <- q_19 %>% 
  gather(Q,Response)  %>% 
    group_by(Response) %>%
      summarize(count_response = n())
```
Question 20
```{r}
q_20 <- DataScientists %>% 
  select(starts_with("Q20")& !"Q20_OTHER_TEXT")

q_20 <-q_20 %>% 
  gather(Q20,response)  %>% 
    group_by(response) %>%
      summarize(count_response = n())
```
Question 24
```{r}
q_24 <- DataScientists %>% 
  select(starts_with("Q24")& !"Q24_OTHER_TEXT")

q_24 <-q_24 %>% 
  gather(Q,response)  %>% 
    group_by(response) %>%
      summarize(count_response = n())
```
Question 25
```{r}
q_25 <- DataScientists %>% 
  select(starts_with("Q25")& !"Q25_OTHER_TEXT")
q_25 <-q_25 %>% 
  gather(Q,response)  %>% 
    group_by(response) %>%
      summarize(count_response = n())
```
Question 26
```{r}
q_26 <- DataScientists %>% 
  select(starts_with("Q26")& !"Q26_OTHER_TEXT")
q_26 %>% 
  gather(Q26,response)  %>% 
    group_by(response) %>%
      summarize(count_response = n())

```
Question 27
```{r}
q_27 <- DataScientists %>% 
  select(starts_with("Q27")& !"Q27_OTHER_TEXT")
q_27 %>% 
  gather(Q27,response)  %>% 
    group_by(response) %>%
      summarize(count_response = n())
```
Question 28
```{r}
q_28 <- DataScientists %>% 
  select(starts_with("Q28")& !"Q28_OTHER_TEXT")
q_28 %>% 
  gather(Q28,response)  %>% 
    group_by(response) %>%
      summarize(count_response = n())
```
Question 29
```{r}
q_29 <- DataScientists %>% 
  select(starts_with("Q29")& !"Q29_OTHER_TEXT")

q_29 <-q_29 %>% 
  gather(Q29,response)  %>% 
    group_by(response) %>%
      summarize(count_response = n())
```
Question 30
```{r}
q_30 <- DataScientists %>% 
  select(starts_with("Q30")& !"Q30_OTHER_TEXT")
q_30 <- q_30 %>% 
  gather(Q30,response)  %>% 
    group_by(response) %>%
      summarize(count_response = n())
```
Question 31
```{r}
q_31 <- DataScientists %>% 
  select(starts_with("Q31")& !"Q31_OTHER_TEXT")

q_31 <-
q_31 %>% 
  gather(Q31,response)  %>% 
    group_by(response) %>%
      summarize(count_response = n())
```
Question 32
```{r}
q_32 <- DataScientists %>% 
  select(starts_with("Q32")& !"Q32_OTHER_TEXT")
q_32<- q_32 %>% 
  gather(Q,response)  %>% 
    group_by(response) %>%
      summarize(count_response = n())
```
Question 33
```{r}
q_33 <- DataScientists %>% 
  select(starts_with("Q33")& !"Q33_OTHER_TEXT")
q_33 <-q_33 %>% 
  gather(Q33,response)  %>% 
    group_by(response) %>%
      summarize(count_reponse = n())
```
Question 34
```{r}
q_34 <- DataScientists %>% 
  select(starts_with("Q34")& !"Q34_OTHER_TEXT")
q_34 <-q_34 %>% 
  gather(Q,response)  %>% 
    group_by(response) %>%
      summarize(count_response = n())
```

## Combining data frames

It looks like the majority of the skills-based questions can be categorized into the following areas-
Programming Languages: Questions 18 and 19
Data Visualization: Question 20
ML Tools and Products: Questions 25,32 and 33
ML Algorithms and Framework: Questions 24 and 28
Big Data: Question 31
Cloud Platforms: Questions 29 and 30
Relational Databases:Question 34 

We are particularly interested in understanding what the most cited tools or skills were for 

However, since we are currently storing the responses from each survey question into individual data frames, we will first need to combine the data frames that fall under an area of focus. 

questions 25 (Which categories of ML tools do you use on a regular basis?),32 (Which of the following machine learning products do you use on a regular basis?) and 33 (Which automated machine learning tools (or partial AutoML tools) do you use on a regular basis? ) can all be categorized under ML Tools/ Products

### Most cited ML Tools/Products

```{r}
ML <- rbind(q_25,q_32,q_33)
ML

```
```{r}
ML <-ML %>% 
    group_by(response) %>%
      summarize(sum_response= sum(count_response))
ML

```
```{r}
ggplot(data=ML, aes(x=response,y=sum_response, fill=response))+geom_col()+ geom_text(label=(ML$sum_response))+
  ggtitle("ML Tools and Products")
## Where is the graph??
```
### Programming Languages
```{r}
PL <- rbind(q_18,q_19)
PL <-PL %>% 
    group_by(Response) %>%
      summarize(sum_response= sum(count_response))
PL
```
```{r}
ggplot(data=PL, aes(x=Response,y=sum_response, fill=Response))+geom_col()+ geom_text(label=(PL$sum_response))+
  ggtitle("Programming Languages")
##Overlap
```

# Dataset 2 (Other Text responses)
Free form responses for those who selected the other option in the main multiple choice survey.

## Data
```{r}
Data2 <- dbGetQuery(my_connection,"Select * FROM dbo.other_text_responses")
```



## Filtering out non-data roles
We are only going to look at respondents primary responsibilities presumably entail working with data on a daily basis, given their titles.

```{r}
DataRoles <- dbGetQuery(my_connection,"Select * 
           FROM dbo.other_text_responses
           WHERE 
           [Q5_OTHER_TEXT] like '%Data%' OR 
           [Q5_OTHER_TEXT] like '%Machine     Learning%' 
OR [Q5_OTHER_TEXT] like   '%Artifical Intelligence%' OR [Q5_OTHER_TEXT] like '%Business Intelligence%'
OR  [Q5_OTHER_TEXT] like '%Analytics%'
OR  [Q5_OTHER_TEXT] like '%Algorithm%'
OR  [Q5_OTHER_TEXT] like '%Analyst%'
OR  [Q5_OTHER_TEXT] like '%Developer%'
OR  [Q5_OTHER_TEXT] like '%AI%'
OR  [Q5_OTHER_TEXT] like '%Programmer%'
OR  [Q5_OTHER_TEXT] like '%Math%'")
DataRoles
```
## Responses
We are primarily interested in extracting 'soft skills'data from this dataset.

We will also look at the survey question for which a significant number of respondents picked the 'other' option.

### Soft skills
It seems like we maybe able to get insights about soft skills from respondents who picked the other option for Question 9 (Select any activities that make up an important part of your role at work: (Select all that apply) 
```{r}
SoftSkills <- DataRoles %>% 
  select("Q9_OTHER_TEXT")


SoftSkills %>% 
  gather(Q9other,response)  %>% 
    group_by(response) %>%
      summarize(count_reponse = n())
```
The only soft(ish) skill indicated by our data professionals (216 respondents) is the ability to build business cases for new model development and deployment (indicated by 1 respondent)

### Tool

The survey question where a significant amount of respondents picked the other option is Question 14 (What is the primary tool that you use at work or school to analyze data? (Include text response) - Selected Choice)

```{r}
PrimaryTool <- DataRoles %>% 
  select("Q14_OTHER_TEXT")


PrimaryTool %>% 
  gather(Q14other,response)  %>% 
    group_by(response) %>%
      summarize(count_reponse = n())
```

